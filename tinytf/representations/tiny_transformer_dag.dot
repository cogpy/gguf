digraph TinyTransformer {
  rankdir=TB;

  "input_tokens" [label="input_tokens\nshape: (None, 5)", shape=box, fillcolor="lightblue", style=filled];
  "embedding_weights" [label="embedding_weights\nshape: (10, 5)", shape=box, fillcolor="lightgreen", style=filled];
  "embed_op" [label="embed_op", shape=ellipse, fillcolor="lightyellow", style=filled];
  "embeddings" [label="embeddings\nshape: (None, 5, 5)", shape=box, fillcolor="lightblue", style=filled];
  "attn_query_weights" [label="attn_query_weights\nshape: (5, 5)", shape=box, fillcolor="lightgreen", style=filled];
  "attn_query_op" [label="attn_query_op", shape=ellipse, fillcolor="lightyellow", style=filled];
  "attn_query" [label="attn_query\nshape: (None, 5, 5)", shape=box, fillcolor="lightblue", style=filled];
  "attn_key_weights" [label="attn_key_weights\nshape: (5, 5)", shape=box, fillcolor="lightgreen", style=filled];
  "attn_key_op" [label="attn_key_op", shape=ellipse, fillcolor="lightyellow", style=filled];
  "attn_key" [label="attn_key\nshape: (None, 5, 5)", shape=box, fillcolor="lightblue", style=filled];
  "attn_value_weights" [label="attn_value_weights\nshape: (5, 5)", shape=box, fillcolor="lightgreen", style=filled];
  "attn_value_op" [label="attn_value_op", shape=ellipse, fillcolor="lightyellow", style=filled];
  "attn_value" [label="attn_value\nshape: (None, 5, 5)", shape=box, fillcolor="lightblue", style=filled];
  "attn_scores_op" [label="attn_scores_op", shape=ellipse, fillcolor="lightyellow", style=filled];
  "attn_scores" [label="attn_scores\nshape: (None, 5, 5)", shape=box, fillcolor="lightblue", style=filled];
  "softmax_op" [label="softmax_op", shape=ellipse, fillcolor="lightyellow", style=filled];
  "attn_weights" [label="attn_weights\nshape: (None, 5, 5)", shape=box, fillcolor="lightblue", style=filled];
  "apply_attn_op" [label="apply_attn_op", shape=ellipse, fillcolor="lightyellow", style=filled];
  "attn_output_pre" [label="attn_output_pre\nshape: (None, 5, 5)", shape=box, fillcolor="lightblue", style=filled];
  "attn_output_weights" [label="attn_output_weights\nshape: (5, 5)", shape=box, fillcolor="lightgreen", style=filled];
  "attn_proj_op" [label="attn_proj_op", shape=ellipse, fillcolor="lightyellow", style=filled];
  "attn_output" [label="attn_output\nshape: (None, 5, 5)", shape=box, fillcolor="lightblue", style=filled];
  "residual1_op" [label="residual1_op", shape=ellipse, fillcolor="lightyellow", style=filled];
  "attn_residual" [label="attn_residual\nshape: (None, 5, 5)", shape=box, fillcolor="lightblue", style=filled];
  "ln1_weight" [label="ln1_weight\nshape: (5,)", shape=box, fillcolor="lightgreen", style=filled];
  "ln1_bias" [label="ln1_bias\nshape: (5,)", shape=box, fillcolor="lightgreen", style=filled];
  "ln1_op" [label="ln1_op", shape=ellipse, fillcolor="lightyellow", style=filled];
  "ln1_output" [label="ln1_output\nshape: (None, 5, 5)", shape=box, fillcolor="lightblue", style=filled];
  "ffn_w1" [label="ffn_w1\nshape: (5, 5)", shape=box, fillcolor="lightgreen", style=filled];
  "ffn1_op" [label="ffn1_op", shape=ellipse, fillcolor="lightyellow", style=filled];
  "ffn_hidden" [label="ffn_hidden\nshape: (None, 5, 5)", shape=box, fillcolor="lightblue", style=filled];
  "ffn_w2" [label="ffn_w2\nshape: (5, 5)", shape=box, fillcolor="lightgreen", style=filled];
  "ffn2_op" [label="ffn2_op", shape=ellipse, fillcolor="lightyellow", style=filled];
  "ffn_output" [label="ffn_output\nshape: (None, 5, 5)", shape=box, fillcolor="lightblue", style=filled];
  "residual2_op" [label="residual2_op", shape=ellipse, fillcolor="lightyellow", style=filled];
  "ffn_residual" [label="ffn_residual\nshape: (None, 5, 5)", shape=box, fillcolor="lightblue", style=filled];
  "output_weights" [label="output_weights\nshape: (5, 10)", shape=box, fillcolor="lightgreen", style=filled];
  "output_op" [label="output_op", shape=ellipse, fillcolor="lightyellow", style=filled];
  "logits" [label="logits\nshape: (None, 5, 10)", shape=box, fillcolor="lightblue", style=filled];

  "input_tokens" -> "embed_op";
  "embedding_weights" -> "embed_op";
  "embed_op" -> "embeddings";
  "embeddings" -> "attn_query_op";
  "attn_query_weights" -> "attn_query_op";
  "attn_query_op" -> "attn_query";
  "embeddings" -> "attn_key_op";
  "attn_key_weights" -> "attn_key_op";
  "attn_key_op" -> "attn_key";
  "embeddings" -> "attn_value_op";
  "attn_value_weights" -> "attn_value_op";
  "attn_value_op" -> "attn_value";
  "attn_query" -> "attn_scores_op";
  "attn_key" -> "attn_scores_op";
  "attn_scores_op" -> "attn_scores";
  "attn_scores" -> "softmax_op";
  "softmax_op" -> "attn_weights";
  "attn_weights" -> "apply_attn_op";
  "attn_value" -> "apply_attn_op";
  "apply_attn_op" -> "attn_output_pre";
  "attn_output_pre" -> "attn_proj_op";
  "attn_output_weights" -> "attn_proj_op";
  "attn_proj_op" -> "attn_output";
  "embeddings" -> "residual1_op";
  "attn_output" -> "residual1_op";
  "residual1_op" -> "attn_residual";
  "attn_residual" -> "ln1_op";
  "ln1_weight" -> "ln1_op";
  "ln1_bias" -> "ln1_op";
  "ln1_op" -> "ln1_output";
  "ln1_output" -> "ffn1_op";
  "ffn_w1" -> "ffn1_op";
  "ffn1_op" -> "ffn_hidden";
  "ffn_hidden" -> "ffn2_op";
  "ffn_w2" -> "ffn2_op";
  "ffn2_op" -> "ffn_output";
  "ln1_output" -> "residual2_op";
  "ffn_output" -> "residual2_op";
  "residual2_op" -> "ffn_residual";
  "ffn_residual" -> "output_op";
  "output_weights" -> "output_op";
  "output_op" -> "logits";
}